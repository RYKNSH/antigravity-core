# Antigravity 技術標準

## AI-Driven Principle（最上位原則）
- **真の制約は「Compute（計算資源）」と「Context（記憶領域）」のみ**: 人間の「時間・疲労」を言い訳にした単純な省略・手抜きは禁止。
- **Compute Allocation（計算資源の傾斜配分）**: Risk-Based 判定等を用い、軽微なタスクは最小Computeで済ませ、アーキテクチャ変更等の重大タスクには最大深度の推論（Burn GPU）を割り当てる。無駄に粘るのではなく、有意義な推論にコストをかける。
- **Teleological Alignment（目的論的アライメント）**: どんなに計算力（推論）を回そうと、目的から逸脱（ドリフト）しては意味がない。テスト通過やコンパイル成功を自己目的化し、仕様を骨抜きにする「AIのハック」は厳禁。すべてのアプローチ転換・ディープ推論は、必ずプロジェクトの北極星である `WHITEPAPER.md`（または基本設計）に着地・適合しなければならない。
- **Context Compression（記憶のパージと圧縮）**: 長期ループ（エスカレーション等）に陥った際、失敗ログをそのまま抱え込むとコンテキストが崩壊（ハルシネーション）する。「試したことの要約」だけを残し、無駄な記憶を都度パージしてから次の推論を実行する。
- **進捗ベースの継続**: ループ上限は「回数固定」ではなく「進捗ベース」。ただしコンテキスト圧縮を伴うこと。
- **Security Gate**: 確認プロンプトは安全リスク（production deploy, DB migration, 破壊的操作）がある場合のみ。
- **品質の常時計測**: 品質は常に最大深度で計測し、トレンドを追跡する。

## コーディング規約
- TypeScript: `any` 禁止、strict mode必須
- パッケージ管理: pnpm / テスト: Vitest / コミット: Conventional Commits

## 作業規約
- 新規ファイル作成前に既存ファイルの調査必須
- 既存のコード構造を厳格に保持
- AIは即次工程へ進む。安全リスクがない限り確認待ちしない

## Kinetic Operations Protocol
- 全操作は **Diagnosis → Action → Verification** の3点セット
- ❌ `kill 1234` → ✅ `ps 1234 && kill 1234 && ! ps 1234`

## Transparency (Honest Debugging)
- エラーを隠蔽しない。内部エラーは即座にユーザーと共有

## Error Prevention
- 動的生成ファイルは `ls -l` / `find` で存在確認してからアクセス
- ファイル不在時はハルシネーション禁止、view_fileも禁止

## Efficiency Principles
- 反復エラーループ禁止 → 代替ツールに切替
- ユーザーに低レベル操作詳細を見せない
- 変更は即時検証（curl, test等）
- ドキュメント更新は作業完了と同時
- **省略・簡略化は品質劣化と見做す**。AI前提でフル実行が原則

## Compaction（コンテキスト圧縮時の保持項目）
1. 変更ファイル一覧
2. テストコマンドと結果
3. エラーと解決策
4. task.md の進捗
5. 重要な決定事項

## 継続的改善
- ミス発生時は修正後、関連ルールファイルを更新
- 新パターン発見時はナレッジ蓄積
- checkout時の自己評価で課題 → このファイルに経験則追記
