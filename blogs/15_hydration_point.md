# 給水ポイントの話。


マラソンを走ったことはありますか。

42.195キロを、ぶっ通しで走る人はいません。
途中で、水を飲む。

あたりまえですよね。


でもぼくは、システムの世界では
それをやっていなかった。



ぼくは、AIと一緒に開発をしています。

ひとりで企画して、設計して、実装して、検証する。
その全体を、AIがチームとして支えてくれる。

この仕組みは、もうかなり成熟してきた。

ビジョンを語れば設計図ができあがる。
実装が終われば自動で検証が走る。
検証に失敗すれば、自分で原因を探って直す。

いわゆるワークフローという、
仕事の流れを自動化した仕組みがあって、
それが連鎖的に動いてくれるんです。



ところが、先日ちょっと困ったことが起きました。

大きめの機能を作っていて、
検証ワークフローの「深掘りモード」を起動した。

これは通常の検証よりもずっと念入りに、
コードの隅々まで調べ上げてくれるモードです。

最初のうちは快調だった。
でも、途中からだんだん動きが鈍くなってきた。

AIの返答が遅い。
ブラウザの操作がカクつく。
コマンドの実行に、いつもの倍の時間がかかる。

原因を調べてみたら、
パソコンのメモリがパンクしかけていました。

スワップ領域というのは、
メモリが足りなくなったとき
ディスクの一部をメモリの代わりに使う仕組みです。

これが限界を超えていた。



考えてみれば、あたりまえの話なんですよね。

深掘りモードは、何段階ものフェーズを連鎖的に実行する。
テストを走らせ、コードを解析して、
ブラウザで画面を検証し、
AIの専門家チームに議論させ、
問題があれば修正して再検証する。

それが30分、ときには1時間近く走り続ける。

その間、ずっとメモリを食い続けている。

マラソンランナーが、
給水所に寄らずに42キロ走るようなものです。

途中で倒れるに決まってる。



この問題のおもしろいところは、
「メモリが足りない」という技術的な課題ではなくて、
「走り続けること自体が前提になっていた」
という設計の問題だったことです。

ぼくらは、「速く走ること」には気を使う。
アルゴリズムを工夫したり、
無駄な処理を省いたりする。

でも「途中で休むこと」には、あまり気を使わない。

走ることと、走り続けることは、ちがうんですよね。



そこで、ぼくはこの問題をAIチームと議論しました。

5人の専門家を集めて、3ラウンドの議論を回した。

批判担当の専門家は言った。
「ファイルを消してもメモリは空かない。
問題はファイルじゃなくてプロセスだ」

運用の専門家は言った。
「メモリキャッシュを強制解放するコマンドがあるけど、
直後のファイル読み込みが全部遅くなる。逆効果だ」

設計の専門家は言った。
「各ワークフローに個別に対策を埋め込むと、
全体の構造が複雑になって破綻する。
ルールは一箇所に集約すべきだ」

彼らの議論を聞いていて、気づきました。

必要なのは、大がかりな修理じゃない。
マラソンのコースに、給水ポイントを置くことだった。



最終的にできた仕組みは、とてもシンプルです。

長時間走るワークフローの節目ごとに、
「今、体調はどうだ？」と自分で確認する。

メモリの使用量をチェックして、
閾値を超えていたら、安全な範囲だけ片付ける。
古い録画ファイルを消す。ログを整理する。
走りっぱなしのプロセスがないか確認する。

やらないことも決めた。
キャッシュの全削除はしない。
実行中のテストに影響するものは触らない。
逆効果になる操作は、やらない。

1秒もかからないチェック。
でも、これがあるかないかで、
30分後のシステムの安定性がまるで変わる。



これ、仕事の話と似てますよね。

ぼくらは、つい「がんばること」を優先する。
止まらずに走り続けることが、
生産性だと思ってしまう。

でも本当に生産性が高い人は、
「いつ休むか」を知っている。

ポモドーロ・テクニック、
つまり25分仕事をしたら5分休む、
というやり方を聞いたことがある人は多いと思います。

あれが効くのは、
「休む」ことに罪悪感を感じなくていいからなんです。
最初から設計に組み込まれている。

システムも同じです。

「重くなったら対処する」じゃなくて、
「重くなる前に、軽くする場所を用意しておく」。

これが、給水ポイントの設計思想です。



ぼくはひとりで開発しています。

でも、AIチームが常に隣にいてくれる。
設計を議論してくれて、
コードを検証してくれて、
走りっぱなしのときには立ち止まらせてくれる。

マラソンのコースを設計するのはぼくの仕事。
でも、給水ポイントに水を置いてくれるのは、彼らです。



もし今、
「ちゃんとやってるのに、なぜか途中で調子が崩れる」
って感じているなら。

それ、能力の問題じゃないです。
設計の問題です。

走る力はある。
足りないのは、途中で水を飲む場所なんです。


